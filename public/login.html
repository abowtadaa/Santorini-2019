<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My document</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
    <div class="topnav">
        <div class="class_Class">
        <a href="index.html">Home</a>
    </div>
        <a class="active" href="login.html">Login</a>
        <a href="register.html">Sign up</a>
        <a href="gameBoard.html">Games</a>
    </div>

    <h3>Santorini</h3>
    <input type="text" id="inpEmail" placeholder="E-mail">
    <input type="password" id="inpPassword" placeholder="Password">
    <br><br>
    <button id="btnlogin">Login</button>
    <h3 id="txtResult">Result...</h3>

    <div id="container"></div>



    <!-- HTML elements here... -->

</body>

<script>
    let email = document.getElementById("inpEmail");
    let password = document.getElementById("inpPassword");
    let btnlogin = document.getElementById("btnlogin");
    let txtResult = document.getElementById('txtResult');

    btnlogin.addEventListener('click', async function (evt) {

        let url = "http://localhost:8000/users/login";

        let updata = {
            email: inpEmail.value,
            password: inpPassword.value
        };

        let cfg = {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(updata)
        };

        try {
            let resp = await fetch(url, cfg);
            let data = await resp.text();
            console.log(data.email);

            if (resp.status > 202) {
                txtResult.innerHTML = "Wrong username or password";
                throw (data);
            };
            

            txtResult.innerHTML = "Login successful";
            sessionStorage.setItem("logindata", JSON.stringify(data));
            window.location.href = "startgame.html";
        }
        catch (err) {
            console.log(err);
        }
    });

</script>

</html>