<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My document</title>
</head>

<body>
    <h3>Santorini</h3>

    <button onclick="btnhome()">Home</button>
    <button>Games</button>
    <button onclick="btnlogin()">Login</button>

    <h1>Sign up</h1>

    <div id="container">
        <input type="text" id="username" placeholder="User name">
        <input type="text" id="inpEmail" placeholder="E-mail">
        <br>
        <input type="password" id="inpPassword" placeholder="Password">
        <br><br>
        <button id="btnregisterUser">Create user</button>
        <h3 id="txtResult">Result...</h3>
    </div>

</body>

<script>

    let container = document.getElementById("container");
    let inpEmail = document.getElementById("inpEmail");
    //let eMailCheck = document.getElementById("e-mail-check");
    let username = document.getElementById("username");
    let password = document.getElementById("password");
    let btnregisterUser = document.getElementById("btnregisterUser");
    /*function btnregisterUser () {

        console.log(userName.value);
        console.log(password.value);

        sendRequest();

    }*/
    btnregisterUser.addEventListener('click', async function (evt) {
        let url = "http://localhost:8000/users";

        let updata = {
            username: username.value,
            email: inpEmail.value,
            password: inpPassword.value
        };

        let cfg = {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(updata)
        };

        try {
            let resp = await fetch(url, cfg);
            console.log(resp);
            let data = await resp.json();
            txtResult.innerHTML = data.msg;
        }
        catch (err) {
            console.log(err);
        }
    });


    /*async function sendRequest() {

        if (eMail.value === eMailCheck.value) {
            if (checkUser(userName.value)) {


                //container.innerHTML = "";
                let HTML = `
            <p3>${data}</p3>
            `;
                let div = document.createElement("div");
                div.innerHTML = HTML;
                container.appendChild(div);

                console.log(data); //hello from POST
            }

        } else {
            console.log("The email is not the same!")
        }
    }*/

    /*function checkEmail() {
        if (eMail.value === eMailCheck.value) {
            return true
        }
    }

    function checkUser(input) {
        let output = input;
        if (input) {
            let whitespace = /\s/.test(input);
            if (whitespace) {
                console.log("You cant have spaces in your username!");
                return false
            }
            let slashes = /\//.test(output);
            if (slashes) {
                sendError("You cant have slashes in your username!");
                return false
            }
            let questions = /\?/.test(output);
            if (questions) {
                sendError("You cant have '?' in your username!");
                return false;
            }
            let percent = /%/.test(output);
            if (percent) {
                sendError("You cant have '%' in your username!");
                return false;
            }
            if (!output) {
                sendError("Valid usernames are filtered for whitespace, forward slashes, questions marks and percent signs.");
                return null;
            }
            return true;
        }
        else {
            return null;
        }
    }

    function sendError(err) {
        console.log(err);
    }

    function btnlogin() {
        window.location.href = "login.html";
    }
    function btnhome() {
        window.location.href = "index.html";
    }
    /* JavaScript here... */

</script>

</html>